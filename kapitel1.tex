\chapter{Grammatiken}

In diesem Kapitel lernen wir, wie man Grammatiken definiert und Wörter aus diesen Grammatiken erzeugt.

\section{Symbole}
Symbole sind alle verwendbaren Zeichen um durch Kombination Wörter zu erschaffen.

\section{Alphabet}
Ein Alphabet, abgekürzt $\Sigma$ (Sigma), ist eine endliche Menge von einzelnen Symbolen. Ein Alphabet wird als endliche Menge von Symbolen definiert.

$\Sigma = \{\smiley, a, Anton\}$

Neben einzelnen Buchstaben können auch Wörter im Sinne der deutschen Sprache verwendet werden. Es können aber auch andere Symbole (\smiley) verwendet werden. Bei Verwendung von Wörtern als Symbole eines Alphabets ist aber zu beachten, dass bei der späteren Verwendung die einzelnen Buchstaben oder Teile des Wortes nicht als Symbole genommen werden dürfen, sondern das gesamte Wort als ein Symbol bezeichnet wird. Im hier verwendeten Fall darf also das große $A$ nicht als Symbol verwendet werden darf. ebenso dürfen auch keine Wortteile wie $ton$ nicht verwendet werden. Ein zulässiges Symbol ist allerdings das gesamte Wort $Anton$.

\section{Wörter}
Wörter werden aus Kombination von einzelnen Symbolen gebildet. Die bildbaren Wörter werden in einer Menge $\Sigma^{*}$ (Sigma mit Kleene-Stern) gesammelt. Wird die Menge aller Wörter gebildet muss jetzt explizit das leere Wort $\epsilon$ (Epsilon) angegeben werden. Auf Grund der in der Grammatik verwendeten Regeln wird die Menge der möglichen Wörter eingeschränkt. In unserem Beispiel kann die Menge aller Wörter so aussehen:

$\Sigma^{*} = \{\epsilon, \smiley, a, Anton, \smiley a, a Anton, \smiley Anton, a \smiley, Anton a, Anton \smiley, \smiley \smiley, ...\}$

Die Menge wird gebildet, in dem erst das leere Wort, dann alle einstelligen Wörter, alle zweistelligen Wörter, alle dreistelligen Wörter usw. in die Menge integriert werden. Die Menge der Wörter ist unendlich, da die Länge der Wörter nicht bestimmt ist.

Die Länge eines Wortes $|w|$ bezeichnet die Anzahl der für das Wort verwendeten Symbole.

\begin{figure}[h]
	$|\epsilon| = 0$
	
	$|a| = 1$
	
	$|Anton| = 1$
	
	$|aa| = 2$
	\caption{Beispiele für Wortlängen}
\end{figure}

\section{Grammatiken}
Eine Grammatik $G$ wird definiert durch:
\begin{itemize}
	\item eine Menge von Variablen $V=\{S,U\}$, die bei der Ableitung verschwinden,
	\item eine Menge von Terminalsymbolen $\Sigma$, gelichbedeutend mit dem definierten Alphabet
	\item ein Startsymbol $S \in V$
	\item und eine Menge von Regeln $P$
\end{itemize}

Formal wird eine Grammatik also beschrieben als:

$G = (V, \Sigma, S, P)$

\subsection{Regeln}
Eine Regel besteht immer aus einer linken und einer rechten Regelseite (Tupel). Bei der Ableitung von Regeln wird der Ausdruck auf der \textcolor[rgb]{0,0,1}{linken Seite} durch den Ausdruck auf der \textcolor[rgb]{0,0.58,0}{rechten Seite} ersetzt.

Bei der Regel $\textcolor[rgb]{0,0,1}{S} \rightarrow \textcolor[rgb]{0,0.58,0}{Anton}$ wird die Variable $S$ durch das Symbol $Anton$ ersetzt. 

\subsection{Ableitung}
Bei der Ableitung von Regeln beginnt man beim Startsymbol (hier $S$) und ersetzt das Startsymbol durch den entsprechenden Ausdruck einer Regel, die auf das Startsymbol passt. Zwischen zwei Ableitungsschritten kommt dann ein Doppelpfeil ($\Rightarrow$). Eine kürzere Schreibweise erlaubt der Doppelpfeil mit Kleene-Stern ($\Rightarrow^{*}$), bei dem nicht jede Regel explizit aufgeschrieben werden muss. Auch 0-Schritte sind bei dieser Ableitungsart zulässig (siehe auch Abschnitt \ref{ref-trans-sigma-kleene}, Seite \pageref{ref-trans-sigma-kleene}).

\begin{figure}[h]
$S \rightarrow Anton$ (Regel der Grammatik)

$S \Rightarrow Anton$ (Ableitung, direkte Anwendung der Regel ohne Zwischenschritte)

$S \Rightarrow^{*} Anton$ (Ableitung, mehrmaliges Anwenden von Regeln mit Zwischenschritten)

\caption{Einfaches Beispiel für eine Ableitung}
\end{figure}

\subsection{Regelalternativen}
Regeln können auch Alternativen enthalten, um mehr Möglichkeiten zu bieten Wörter zu erzeugen.

Alternativen werden auf der rechten Regelseite durch ein Pipe-Symbol ($|$) eingeleitet.
Eine Regel mit Alternativen könnte folgendermaßen aussehen:

$S \rightarrow Anton | Anton \smiley | Anton a$

Dadurch wären die Wörter $Anton$, $Anton \smiley$ und $Anton a$ für die Variable $S$ möglich.

\subsection{Rekursion in Regeln}
\begin{figure}[h]
	$S \rightarrow Anton G$
	
	$G \rightarrow \smiley | \smiley G$
	\caption{Grammatik mit Rekursion}
\end{figure}

Rekursionen in Grammatiken können Wörter erzeugen, deren Länge (Betrag) unendlich lang sind. Eine mögliche Ableitung für die obige Grammatik könnte folgendermaßen lauten.

\begin{figure}[h]
	$S \Rightarrow Anton G$
	
	$\Rightarrow Anton \smiley G$
	
	$\Rightarrow Anton \smiley \smiley$
	\caption{Ableitung für eine rekursive Grammatik}
\end{figure}

Wir sehen also, dass durch die Rekursion auf $G$ die Wörter unendlich lang werden können und durch das Symbol \smiley aufgefüllt werden. Des weitern stellen wir fest, dass Ableitungen erst enden, wenn alle Variablen entfernt, bzw. ersetzt wurden.

\subsection{Mengen von Regeln}
Als weitere Komponente für die Definition von Grammatiken wird die Menge aller Regeln der Grammatik benötigt. Im vorherigen Abschnitt haben wir gelernt, wie Regeln definiert werden. Die Menge der Regeln einer Grammatik ist eine Teilmenge des kartesische Produktes der Elemente aus $V$ und $\Sigma$. Das kartesische Produkt wird durch die Kombination aller Elemente \textcolor[rgb]{0,0,1}{einer Menge} (alles vor dem $\times$) mit sämtlichen Elementen einer \textcolor[rgb]{0,0.58,0}{anderen Menge} (alles nach dem $\times$) gebildet.

\begin{figure}[h]
	$A = \{0,1\}$
	
	$B = \{x\}$
	
	$\textcolor[rgb]{0,0,1}{A} \times \textcolor[rgb]{0,0.58,0}{B} = \{(\textcolor[rgb]{0,0,1}{0},\textcolor[rgb]{0,0.58,0}{x}),(\textcolor[rgb]{0,0,1}{1},\textcolor[rgb]{0,0.58,0}{x})\}$
	\caption{Kartesisches Produkt der Mengen A und B}
\end{figure}

Die Menge aller Regeln einer Grammatik wird nun durch $(V\cup\Sigma)^*\times(V\cup\Sigma)^*$ gebildet. Durch diese Definition lassen sich sämtliche Kombinationen aus Terminalsymbolen und Variablen auf beden Seiten der Regeln ausfstellen. Es ist aber meistens gewünscht nur ein paar bestimmte Regeln zuzulassen. Man bildet also eine bestimmte Teilmenge der eben gebildeten Gesamtmenge.

\begin{balken}
\hinweis{}
\textbf{Unterschied zwischen $\{\}$ und $()$} \newline
Bei Verwendung von $\{\}$ ist die Reihenfolge und Anordnung der Elemente egal, da es sich um eine Menge handelt.
Bei Verwendung von $()$ ist die Anordnung der Elemente \textbf{nicht} egal.
\end{balken} 

\subsection{Überprüfung der Regeln}
Um sicherzustellen, dass eine Grammatik eine bestimmte Sprache erzeugt, müssen Überprüfungen bezüglich der Vollständigkeit und Korrektheit dieser Grammatik erfolgen (siehe auch Abschnitt \ref{alt-notation-grammatik}, Seite \pageref{alt-notation-grammatik}).

\paragraph{Vollständigkeit}
Eine Grammatik ist vollständig, wenn sie (alle) Wörter der Sprache erzeugt.

\paragraph{Korrektheit}
Eine Grammatik ist korrekt, wenn sie keine Wörter ausserhalb der Sprache erzeugt.

\section{Kontextfrei oder regulär}
Kontextfreie Grammatiken haben auf der linken Regelseite genau \textbf{eine} Variable und eine Beliebige Kombination aus Terminalsymbolen und Variablen auf der rechten Regelseite. Grammatiken sind regulär, wenn die verwendeten Regeln auf der linken Regelseite \textbf{eine} Variable und auf der rechten Seite entweder das leere Wort ($\epsilon$), genau ein Terminalsymbol oder genau ein Terminalsymbol und eine Variable besitzen.

\begin{figure}[h]
\begin{tabbing}
    \hspace*{1cm}\=\hspace*{3cm}\=\hspace*{3cm}\=\hspace*{2.7cm}\= \kill
    \= \textbf{Allgemein:} \> $P \subseteq (V \cup \Sigma)^{*} \times (V \cup \Sigma)^{*}$ \\
    \= \textbf{Kontextfrei:} \> $P \subseteq (V) \times (V \cup \Sigma)^{*}$ \\
		\= \textbf{Regulär:} \> $P \subseteq (V) \times (Y \cup \Sigma \cup \{\epsilon\})$ wobei $Y = aV$
\end{tabbing}
\end{figure}

\begin{balken}
\hinweis{}
\textbf{Links- und Rechtsregulär} \newline
In dieser LVA wurde der Begriff "regulär" von Frau Wagner als "rechtsregulär" (immer zuerst rechteste Variable ersetzen) definiert!
\end{balken} 

\section{Alternative Schreibweise für Grammatiken}\label{alt-notation-grammatik}
Um Grammatiken und deren Regeln einfacher kommunizieren zu können kann man die erzeugten Wörter auch als "Formel" aufschreiben. Dazu folgende Aufgabe.

\textbf{Aufgabe:} Sei $\Sigma = \{0,1\}$. Leiten Sie mit der folgenden Grammatik das Wort 0101001010 ab.

\begin{figure}[h]
$S \rightarrow 0T0$

$T \rightarrow 1S1 | \epsilon$
\end{figure}

\textit{Ableitung:}
\begin{figure}[h]
	$S \Rightarrow 0T0$
	
	$\Rightarrow \underline{0}1S1\underline{0}$
	
	$\Rightarrow \underline{01}0T0\underline{10}$
	
	$\Rightarrow \underline{010}1S1\underline{010}$
	
	$\Rightarrow \underline{0101}0T0\underline{1010}$
	
	$\Rightarrow \underline{01010}\underline{01010}$
	\caption{Zugehörige Ableitung}
\end{figure}

Aus dieser Grammatik lassen sich folgende mögliche Wörter ableiten:

\begin{itemize}
	\item 00
	\item 010010
	\item 0101001010
	\item ...
\end{itemize}

Da die Grammatik rekursiv ist und damit die Wortliste nicht endlich ist, kann man unmöglich alle Wörter auflisten. Um alle Wörter die erzeugt werden können trotzdem aufschrieben zu können, kann die Menge der Wörter auch formelähnlich aufgeschrieben werden.

$\{(01)^n00(10)^n|n\geq0\}$

Der erste Teil (01) ist genau so oft enthalten wie der letzte Teil (10) kann aber auch weggelassen werden. der mittlere Teil (00) ist immer vorhanden und kann auch nicht wiederholt werden. Durch diese vereinfachte Schreibweise ist es sehr leicht möglich weitere Wörter zu erzeugen. Man muss nur einen Wert für $n$ einsetzen und wiederholt die entsprechenden Teile $n$-mal.

\textbf{Aufgabe:} Sei $\Sigma=\{0,1\}$. Entwicklen Sie eine Grammatik, die folgende Sprache erzeugt: $L=\{w \in \Sigma^{*} | \left|w\right| \;ist\;gerade\}$

\textit{Ansatz:} Das das zu erzeugende Wort ($w$) ein $\Sigma^{*}$ enthalten sein soll, kann es also aus allen möglichen Kombinationen aus $\Sigma$ (0 und 1) bestehen. Als zusätzliche Beschränkung für die Menge aller Wörter soll der Betrag, also die Länge, des Wortes gerade (durch Zwei teilbar) sein.

Aus dem obigen Ansatz ergeben sich folgende Regeln für die Grammatik.

\begin{figure}[h]
\begin{tabbing}
    \hspace*{1cm}\=\hspace*{4.2cm}\=\hspace*{3cm}\=\hspace*{2.7cm}\= \kill
    \= $S \rightarrow PS | P$ \> (beliebig viele Pärchen aneinanderreihen) \\
    \= $P \rightarrow ZZ | \epsilon$ \> (Pärchen von Zahlen aus Ziffern bilden) \\
		\= $Z \rightarrow 0|1$ \> (Ziffern)
\end{tabbing}
\end{figure}

\begin{figure}[ht]
$S \Rightarrow PS$

$\Rightarrow \underline{P}P$

$\Rightarrow ZZ\underline{P}$

$\Rightarrow \underline{ZZ}ZZ$

$\Rightarrow 0\underline{ZZZ}$

$\Rightarrow \underline{0}1\underline{ZZ}$

$\Rightarrow \underline{01}0\underline{Z}$

$\Rightarrow \underline{0100}$
\caption{Mögliche Ableitung für das Wort 0100}
\end{figure}

\section{Ableitungsbaum}
Aus dieser Ableitung lässt sich ein Ableitungsbaum erstellen. Dieser stellt strukturiert dar, wie ein Wort abgeleitet wird.

\begin{figure}[h]
\pstree[levelsep=8ex]{\Tcircle{S} }{
	\pstree{ \Tcircle{P} }{
		\pstree{ \Tcircle{Z} }{
			\Tcircle{0}
		}
		\pstree{ \Tcircle{Z} }{
			\Tcircle{1}
		}
	}
	\pstree{ \Tcircle{S} }{
		\pstree{ \Tcircle{P} }{
			\pstree{ \Tcircle{Z} }{
				\Tcircle{0}
			}
			\pstree{ \Tcircle{Z} }{
				\Tcircle{0}
			}
		}
	}
}
\caption{Ableitungsbaum für die obige Ableitung}
\end{figure}

Egal in welcher Reihenfolge abgeleitet wird, bleibt der Ableitungsbaum immer der selbe. Die Ableitung nach $S \Rightarrow PS \Rightarrow ZZS \Rightarrow ...$ oder nach $S \Rightarrow PS \Rightarrow PP \Rightarrow ...$ erzeugen den selben Ableitungsbaum. Anders sieht es aus, wenn eine andere Regelalternative zur Ableitung genutzt wird. Dann kann sich der Ableitungsbaum durchaus unterscheiden.

Die Ableitung $S \Rightarrow PS \Rightarrow PPS \Rightarrow PPP \Rightarrow ZZPP \Rightarrow ZZZZP \Rightarrow ZZZZ\epsilon \Rightarrow ...$ erzeugt den folgenden Ableitungsbaum.

\begin{figure}[ht]
\pstree[levelsep=8ex]{\Tcircle{S} }{
	\pstree{ \Tcircle{P} }{
		\pstree{ \Tcircle{Z} }{
			\Tcircle{0}
		}
		\pstree{ \Tcircle{Z} }{
			\Tcircle{1}
		}
	}
	\pstree{ \Tcircle{S} }{
		\pstree{ \Tcircle{P} }{
			\pstree{ \Tcircle{Z} }{
				\Tcircle{0}
			}
			\pstree{ \Tcircle{Z} }{
				\Tcircle{0}
			}
		}
		\pstree{ \Tcircle{S} }{
			\pstree{ \Tcircle{P} }{
				\Tcircle{$\epsilon$}
			}
		}
	}
}
\caption{Ableitungsbaum für eine alternative Ableitung}
\end{figure}

\begin{balken}
\hinweis{}
\textbf{Mehrdeutigkeit} \newline
Da es für die hier verwendete Grammatik strukturell unterschiedliche Ableitungsbäume gibt, ist die Grammatik mehrdeutig. Daher ist es nicht möglich einen Parser für die erzeugte Sprache zu generieren.
\end{balken}

Durch Linksableitung kann Mehrdeutigkeit von Bäumen (Ableitungen) eindeutig bewiesen werden. Die Linksableitung ist eine Konvention, dass von Ableitungsschritt zu Ableitungsschritt die linkeste Variable zuerst abgeleitet wird.

\subsection{Reflexiver \& transitiver Abschluss von $\Rightarrow$} \label{ref-trans-sigma-kleene}
Der Ableitungsoperator $\Rightarrow$ erlaubt es, nur einen Ableitungsschritt darzustellen. Der Ableitungsoperator $\Rightarrow^*$ hingegen erlaubt es beliebg viele Ableitungsschritte zusammenzufassen. Wird eine Grammatik mit dem einfachen Operator so abgeleitet $S \Rightarrow bB \Rightarrow bb$, kann die Ableitung mit dem reflexiven und trasitiven Abschluss so aussehen: $S \Rightarrow^* bb$. Dies spart Zeit und schreibarbeit, ist aber nicht so übersichtlich, da zwischeninformationen über die Ableitungen verloren gehen.

\section{Greibach Normalform (GNF)}
Die Greibach Normalform erzeugt bei jedem ableitungsschritt genau ein Terminalsymbol. Bei der GNF besteht die rechte Regelseite aus genau einem Terminalsymbol und beliebig vielen Variablen ($P \subseteq V \times \Sigma V^{*}$).

Im folgenden werden Regeln besprochen, die aus einer kontextfreien Grammatik eine Grammatik in Greibach Normalform erzeugen.

\subsection{Problem 1: Mehrere Terminalsymbole}
Wenn eine Regel mehrere Terminalsymbole auf der rechten Regelseite besitzt, verstößt sie gegen die GNF. Um das Problem zu lösen, erzeugt man einfach eine neue Variable, die das Terminalsymbol ersetzt.

\begin{figure}[h]
\begin{tabbing}
    \hspace*{0cm}\=\hspace*{3cm}\=\hspace*{3cm}\=\hspace*{3cm}\= \kill
    \= $S \rightarrow a\underline{a}$ \> wird zu \> $S \rightarrow a\underline{A}$ \\
		\= \> \> $\underline{S \rightarrow a}$
\end{tabbing}
\end{figure}

\subsection{Problem 2: Mehrere Variablen, aber kein Terminalsymbol}
Ein weiteres Problem entsteht, wenn zwar mehrere Variablen auf der rechten Regelseite stehen, aber kein Terminalsymbol vorhanden ist. Dazu wird die vorderste Variable durch die rechte Regelseite der Variable ersetzt.

\begin{figure}[h]
\begin{tabbing}
    \hspace*{0cm}\=\hspace*{3cm}\=\hspace*{3cm}\=\hspace*{3cm}\= \kill
    \= $S \rightarrow \underline{B}S | c$ \> wird zu \> $S \rightarrow \underline{b}S | c$ \\
		\= $B \rightarrow b$ \> \> $B \rightarrow b$
\end{tabbing}
\end{figure}

\subsection{Problem 3: Epsilon}
Bei der GNF ist die Verwendung von $\epsilon$ generell untersagt. Überall wo $\epsilon$ einsetzbar ist, muss eine neue rechte Seite ohne $\epsilon$ entstehen (Variable die zu $\epsilon$ führt muss also gestrichen werden).

\begin{figure}[h]
\begin{tabbing}
    \hspace*{0cm}\=\hspace*{3cm}\=\hspace*{3cm}\=\hspace*{3cm}\= \kill
    \= $S \rightarrow aA$ \> wird zu \> $S \rightarrow \underline{a} | aA$ \\
		\= $A \rightarrow bA | \underline{\epsilon}$ \> \> $A \rightarrow bA | \underline{b}$
\end{tabbing}
\end{figure}

Dabei ist zu beachten, dass das kürzeste Wort \textbf{pro Regel} erhalten bleiben muss (für $A$ wurde jeweils $\epsilon$ eingesetzt).

$S \Rightarrow aA \Rightarrow \underline{a}$ \newline
$A \Rightarrow bA \Rightarrow \underline{b}$